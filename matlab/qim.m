% 四元数除法 q = q1^-1 * q2
% q = Qim(q1,q2)
% q = Qm([-q1(1); -q1(2); -q1(3); q1(4)] , q2)
function q = qim(q1,q2)
error(nargchk(2,2,nargin));
q = [-q2(4), -q2(3),  q2(2),  q2(1);
      q2(3), -q2(4), -q2(1),  q2(2);
     -q2(2),  q2(1), -q2(4),  q2(3);
      q2(1),  q2(2),  q2(3),  q2(4)]*q1;
% 下面的表达式与上面的结果相同，仅形式不同
%q = [q1(4),  q1(3), -q1(2),-q1(1);
%    -q1(3),  q1(4),  q1(1),-q1(2);
%     q1(2), -q1(1),  q1(4),-q1(3);
%     q1(1),  q1(2),  q1(3), q1(4)]*q2;
if q(4)<0
    q = -q;
end
